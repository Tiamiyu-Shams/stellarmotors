{% extends "base.html" %}
{% block title %}Admin â€” Stellar Motors{% endblock %}

{% block content %}
<div class="flex items-center justify-between gap-4 mb-6">
  <h2 class="text-2xl font-bold">Admin Dashboard</h2>
  <div class="text-sm text-slate-600">Signed in as <strong>{{ username }}</strong></div>
  <a href="{{ url_for('main.add_car') }}"
    class="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-4">
    + Add New Car
  </a>
  <a href="{{ url_for('admin.add_seller') }}"
   class="inline-block bg-green-600 text-white px-4 py-2 rounded mb-4">
   Add Seller
</a>
<a href="{{ url_for('admin.sellers') }}"
   class="inline-block bg-green-600 text-white px-4 py-2 rounded mb-4">
   Seller List
</a>


</div>

<!-- Add car form (left) and stats/controls (right) -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
  <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow">
    <h3 class="font-semibold mb-4">Add New Car</h3>
    <form method="POST" action="{{ url_for('admin.add_car') }}" enctype="multipart/form-data"
      class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <input name="title" placeholder="Car title" class="p-2 border rounded col-span-2" required>
      <textarea name="description" placeholder="Short description" class="p-2 border rounded col-span-2"
        rows="3"></textarea>
      <input name="price" type="number" step="0.01" placeholder="Price" class="p-2 border rounded">
      <input name="seller_name" placeholder="Seller name" class="p-2 border rounded">
      <input name="category" placeholder="Category (e.g. SUV, Sedan)" class="p-2 border rounded">
      <label class="col-span-2">
        Car image:
        <input type="file" name="image" accept="image/*" onchange="previewImage(event,'carPreview')"
          class="w-full mt-1">
      </label>
      <img id="carPreview" src="/static/images/default_car.jpg"
        class="h-36 w-full object-cover rounded col-span-2 border mt-1">
      <label class="col-span-2">
        Seller photo:
        <input type="file" name="seller_photo" accept="image/*" onchange="previewImage(event,'sellerPreview')"
          class="w-full mt-1">
      </label>
      <img id="sellerPreview" src="/static/images/default_seller.jpg"
        class="h-20 w-20 object-cover rounded-full border mt-1">
      <div class="col-span-2">
        <button class="bg-primary-900 text-white px-4 py-2 rounded mt-3">Add Car</button>
      </div>
    </form>
  </div>

  <aside class="bg-white p-6 rounded-lg shadow">
    <h3 class="font-semibold mb-3">Controls</h3>
    <p class="text-sm text-slate-600">Tip: Use edit to update details or images.</p>
    <a href="{{ url_for('main.index') }}" class="inline-block mt-3 text-sm text-primary-900 hover:underline">View Public
      Site</a>
  </aside>
</div>

<!-- Cards grid -->
<section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
  {% for car in cars %}
  <div class="bg-white rounded-lg shadow overflow-hidden">
    <img src="{{ car['image'] }}" alt="" class="w-full h-44 object-cover">
    <div class="p-4">
      <div class="flex justify-between items-start gap-3">
        <div>
          <h4 class="font-semibold">{{ car['title'] }}</h4>
          <p class="text-sm text-slate-600 mt-1">{{ car['description']|truncate(80) }}</p>
          <div class="mt-2 text-primary-900 font-bold">&#x20A6;{{ '%.2f'|format(car['price']) }}</div>
        </div>
        <div class="flex flex-col items-end gap-2">
          <a href="{{ url_for('admin.edit_car', car_id=car['id']) }}"
            class="inline-flex items-center gap-2 text-sm bg-sky-50 text-sky-700 px-3 py-1 rounded">
            <!-- edit icon -->
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                d="M15.232 5.232l3.536 3.536M4 20h4l10-10-4-4L4 16v4z" />
            </svg>
            Edit
          </a>
          <a href="{{ url_for('admin.delete_car', car_id=car['id']) }}" onclick="return confirm('Delete this car?');"
            class="inline-flex items-center gap-2 text-sm bg-rose-50 text-rose-700 px-3 py-1 rounded">
            <!-- delete icon -->
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                d="M19 7L5 7M10 11v6M14 11v6M9 7l1-3h4l1 3" />
            </svg>
            Delete
          </a>
        </div>
      </div>

      <div class="mt-3 flex items-center gap-3">
        <img src="{{ car['seller_photo'] }}" alt="{{ car['seller_name'] }}"
          class="w-10 h-10 rounded-full object-cover border">
        <div class="text-sm text-slate-700">{{ car['seller_name'] }}</div>
      </div>
    </div>
  </div>
  {% endfor %}
</section>
{% endblock %}